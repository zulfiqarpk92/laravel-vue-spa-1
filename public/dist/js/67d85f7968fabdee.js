"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[188,946,426,396,607,60],{3668:(t,e,s)=>{s.d(e,{Z:()=>n});const a={props:["label","value","errorMessage"],data:function(){return{popupModal:!1,currentValue:this.value}},watch:{value:function(t,e){t!==e&&(this.currentValue=t)}},methods:{handleInput:function(){this.$emit("input",this.currentValue),this.popupModal=!1}}};const n=(0,s(1900).Z)(a,(function(){var t=this,e=t._self._c;return e("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:t._u([{key:"activator",fn:function(s){var a=s.on,n=s.attrs;return[e("v-text-field",t._g(t._b({attrs:{"error-messages":t.errorMessage,label:t.label,"prepend-icon":"mdi-calendar",readonly:""},model:{value:t.currentValue,callback:function(e){t.currentValue=e},expression:"currentValue"}},"v-text-field",n,!1),a))]}}]),model:{value:t.popupModal,callback:function(e){t.popupModal=e},expression:"popupModal"}},[t._v(" "),e("v-date-picker",{attrs:{scrollable:""},on:{input:t.handleInput},model:{value:t.currentValue,callback:function(e){t.currentValue=e},expression:"currentValue"}})],1)}),[],!1,null,null,null).exports},3188:(t,e,s)=>{s.r(e),s.d(e,{default:()=>l});var a=s(4946),n=s(5060),o=s(396),r=s(3607);const i={components:{CustomerInfo:a.default,SalesList:n.default,PaymentsList:o.default,PurchasesList:r.default},middleware:"auth",props:{customerId:{type:[String,Number],default:"0"}},data:function(){return{currentTab:null,customerInfo:null}},mounted:function(){this.customerId&&this.loadData()},methods:{loadData:function(){var t=this;this.loading=!0,this.$http.get("/api/customers/"+this.customerId).then((function(e){var s=e.data;t.customerInfo=s.data,t.loading=!1})).catch((function(e){console.log(e),t.loading=!1}))}}};const l=(0,s(1900).Z)(i,(function(){var t=this,e=t._self._c;return e("v-row",[e("v-col",{attrs:{lg:"4",md:"5"}},[e("v-row",[e("v-col",{attrs:{cols:"12"}},[e("customer-info",{attrs:{"customer-info":t.customerInfo},on:{customerUpdated:t.loadData}})],1)],1)],1),t._v(" "),t.customerInfo?e("v-col",{attrs:{lg:"8",md:"7"}},[e("v-tabs",{attrs:{centered:"","background-color":"transparent"},model:{value:t.currentTab,callback:function(e){t.currentTab=e},expression:"currentTab"}},[e("v-tab",[t._v("Sales")]),t._v(" "),e("v-tab",[t._v("Payments")]),t._v(" "),e("v-tab",[t._v("Purchases")])],1),t._v(" "),e("v-tabs-items",{staticClass:"mt-5 pa-1",staticStyle:{"background-color":"transparent"},model:{value:t.currentTab,callback:function(e){t.currentTab=e},expression:"currentTab"}},[e("v-tab-item",[e("sales-list",{attrs:{"customer-id":t.customerId}})],1),t._v(" "),e("v-tab-item",[e("payments-list",{attrs:{"user-id":t.customerId}})],1),t._v(" "),e("v-tab-item",[e("purchases-list",{attrs:{"supplier-id":t.customerId}})],1)],1)],1):e("v-col",{attrs:{lg:"8",md:"7"}},[e("v-skeleton-loader",{staticClass:"mx-auto",attrs:{type:"table"}})],1)],1)}),[],!1,null,null,null).exports},4946:(t,e,s)=>{s.r(e),s.d(e,{default:()=>o});var a=s(5714);const n={props:{customerInfo:{type:Object,default:null}},data:function(){return{showModal:!1,nameRules:[function(t){return!!t||"Name is required"},function(t){return t.length<=20||"Name must be less than 20 characters"}],emailRules:[function(t){return!!t||"E-mail is required"},function(t){return/.+@.+/.test(t)||"E-mail must be valid"}],customer:new a.ZP(this.customerInfo)}},computed:{invoicesTotal:function(){var t,e;return null!==(t=null==this||null===(e=this.customerInfo)||void 0===e||null===(e=e.invoices)||void 0===e?void 0:e.reduce((function(t,e){return t+e.totalAmount}),0))&&void 0!==t?t:0},paymentsTotal:function(){var t,e;return null!==(t=null==this||null===(e=this.customerInfo)||void 0===e||null===(e=e.payments)||void 0===e?void 0:e.reduce((function(t,e){return t+e.amount}),0))&&void 0!==t?t:0},balanceTotal:function(){return this.invoicesTotal-this.paymentsTotal}},methods:{updateUser:function(){var t=this;this.customer.put("/api/customers/"+this.customerInfo.id).then((function(e){var s=e.data;t.$store.dispatch("snackbar/showMessage",s.message),t.showModal=!1,t.$emit("customerUpdated")})).catch((function(e){e.response&&e.response.data&&t.$set(t.form,"errorMessage",e.response.data.message),console.log(e)}))}}};const o=(0,s(1900).Z)(n,(function(){var t=this,e=t._self._c;return t.customerInfo?e("v-card",{staticClass:"pt-10"},[e("v-card-title",{staticClass:"flex-column justify-center"},[e("v-avatar",{staticClass:"mb-4",attrs:{color:"grey darken-1",size:"120",rounded:""}}),t._v(" "),e("span",{staticClass:"mb-2"},[t._v(t._s(t.customerInfo.name))]),t._v(" "),e("v-chip",[t._v("\n      "+t._s(t.customerInfo.role)+"\n    ")]),t._v(" "),e("v-card-text",[e("h2",{staticClass:"text-xl font-semibold mb-2",staticStyle:{display:"flex","justify-content":"space-between"}},[t._v("\n        Customer Details\n        "),e("v-btn",{staticClass:"me-3",attrs:{color:"primary",small:""},on:{click:function(e){t.showModal=!0}}},[t._v("\n          Edit\n        ")])],1),t._v(" "),e("v-divider"),t._v(" "),e("v-list",{attrs:{dense:""}},[e("v-list-item",{staticClass:"px-0 mb-n2"},[e("v-list-item-content",[e("v-list-item-title",[e("span",{staticClass:"font-weight-medium me-2"},[t._v("Name:")]),t._v(" "),e("span",{staticClass:"text--secondary"},[t._v(t._s(t.customerInfo.name))])])],1)],1),t._v(" "),e("v-list-item",{staticClass:"px-0 mb-n2"},[e("v-list-item-content",[e("v-list-item-title",[e("span",{staticClass:"font-weight-medium me-2"},[t._v("Phone:")]),t._v(" "),e("span",{staticClass:"text--secondary"},[t._v(t._s(t.customerInfo.phone))])])],1)],1),t._v(" "),e("v-list-item",{staticClass:"px-0 mb-n2"},[e("v-list-item-content",[e("v-list-item-title",[e("span",{staticClass:"font-weight-medium me-2"},[t._v("Email:")]),t._v(" "),e("span",{staticClass:"text--secondary"},[t._v(t._s(t.customerInfo.email))])])],1)],1),t._v(" "),e("v-list-item",{staticClass:"px-0 mb-n2"},[e("v-list-item-content",[e("v-list-item-title",[e("span",{staticClass:"font-weight-medium me-2"},[t._v("Address:")]),t._v(" "),e("span",{staticClass:"text--secondary"},[t._v(t._s(t.customerInfo.address)+" "+t._s(t.customerInfo.city)+" "+t._s(t.customerInfo.province))])])],1)],1),t._v(" "),e("v-list-item",{staticClass:"px-0 mb-n2"},[e("v-list-item-content",[e("v-list-item-title",[e("span",{staticClass:"font-weight-medium me-2"},[t._v("Comments:")]),t._v(" "),e("span",{staticClass:"text--secondary"},[t._v(t._s(t.customerInfo.comments))])])],1)],1),t._v(" "),e("v-list-item",{staticClass:"px-0 mb-n2"},[e("v-list-item-content",[e("v-list-item-title",[e("span",{staticClass:"font-weight-medium me-2"},[t._v("Total Purchases:")]),t._v(" "),e("span",{staticClass:"text--secondary"},[t._v(t._s(t._f("currency")(t.invoicesTotal)))])])],1)],1),t._v(" "),e("v-list-item",{staticClass:"px-0 mb-n2"},[e("v-list-item-content",[e("v-list-item-title",[e("span",{staticClass:"font-weight-medium me-2"},[t._v("Total Payments:")]),t._v(" "),e("span",{staticClass:"text--secondary"},[t._v(t._s(t._f("currency")(t.paymentsTotal)))])])],1)],1),t._v(" "),e("v-list-item",{staticClass:"px-0 mb-n2"},[e("v-list-item-content",[e("v-list-item-title",[e("span",{staticClass:"font-weight-medium me-2"},[t._v("Balance:")]),t._v(" "),e("span",{staticClass:"text--secondary"},[t._v(t._s(t._f("currency")(t.balanceTotal)))])])],1)],1)],1)],1),t._v(" "),e("v-card-actions",[e("v-dialog",{attrs:{persistent:"","max-width":"800px"},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[e("v-card",[e("v-card-title",[e("span",{staticClass:"text-h5"},[t._v("Edit Customer")])]),t._v(" "),e("v-card-text",[e("v-row",[e("v-col",{attrs:{cols:"12",md:"4"}},[e("v-text-field",{attrs:{rules:t.nameRules,"error-messages":t.customer.errors.get("name"),label:"Name",required:""},model:{value:t.customer.name,callback:function(e){t.$set(t.customer,"name",e)},expression:"customer.name"}})],1),t._v(" "),e("v-col",{attrs:{cols:"12",md:"4"}},[e("v-text-field",{attrs:{rules:t.emailRules,"error-messages":t.customer.errors.get("email"),label:"Email",required:""},model:{value:t.customer.email,callback:function(e){t.$set(t.customer,"email",e)},expression:"customer.email"}})],1),t._v(" "),e("v-col",{attrs:{cols:"12",md:"4"}},[e("v-text-field",{attrs:{"error-messages":t.customer.errors.get("phone"),label:"Phone",required:""},model:{value:t.customer.phone,callback:function(e){t.$set(t.customer,"phone",e)},expression:"customer.phone"}})],1)],1),t._v(" "),e("v-row",[e("v-col",{attrs:{cols:"12",md:"4"}},[e("v-text-field",{attrs:{"error-messages":t.customer.errors.get("address"),label:"Address",required:""},model:{value:t.customer.address,callback:function(e){t.$set(t.customer,"address",e)},expression:"customer.address"}})],1),t._v(" "),e("v-col",{attrs:{cols:"12",md:"4"}},[e("v-text-field",{attrs:{"error-messages":t.customer.errors.get("city"),label:"City",required:""},model:{value:t.customer.city,callback:function(e){t.$set(t.customer,"city",e)},expression:"customer.city"}})],1),t._v(" "),e("v-col",{attrs:{cols:"12",md:"4"}},[e("v-text-field",{attrs:{"error-messages":t.customer.errors.get("province"),label:"Province",required:""},model:{value:t.customer.province,callback:function(e){t.$set(t.customer,"province",e)},expression:"customer.province"}})],1)],1),t._v(" "),e("v-row",[e("v-col",{attrs:{cols:"12",md:"12"}},[e("v-textarea",{attrs:{label:"Comments",rows:"2"},model:{value:t.customer.comments,callback:function(e){t.$set(t.customer,"comments",e)},expression:"customer.comments"}})],1)],1),t._v(" "),e("small",{staticClass:"red--text"},[t._v("* indicates required field")])],1),t._v(" "),e("v-card-actions",[e("v-spacer"),t._v(" "),e("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(e){t.showModal=!1}}},[t._v("\n              Close\n            ")]),t._v(" "),e("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:t.updateUser}},[t._v("\n              Update\n            ")])],1)],1)],1)],1)],1)],1):e("v-skeleton-loader",{staticClass:"mx-auto",attrs:{type:"card, list-item-three-line, list-item-two-line"}})}),[],!1,null,null,null).exports},2426:(t,e,s)=>{s.r(e),s.d(e,{default:()=>o});var a=s(5714);const n={components:{DatePicker:s(3668).Z},props:{value:{type:Boolean,required:!0}},data:function(){return{payment:new a.ZP({userId:0,saleId:0,paymentTime:"",paymentMode:"Cash",description:"",reference:"",amount:0}),isOpen:this.value}},watch:{value:function(t,e){t!==e&&(this.isOpen=t)}},methods:{closeModal:function(){this.payment.reset(),this.payment.clear(),this.isOpen=!1,this.$emit("input",this.isOpen)},selectUser:function(t){this.payment.userId=t.id},addPayment:function(){var t=this;this.payment.post("/api/payments").then((function(e){var s;e=e.data,t.$store.dispatch("snackbar/showMessage",null!==(s=e.message)&&void 0!==s?s:"Payment created"),t.closeModal(),t.$emit("reload",!0)})).catch((function(e){e.response&&e.response.data&&t.$set(t.payment,"errorMessage",e.response.data.message);var s=document.getElementById("error-component");s&&s.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})}))}}};const o=(0,s(1900).Z)(n,(function(){var t=this,e=t._self._c;return e("v-dialog",{attrs:{persistent:"","max-width":"600px"},model:{value:t.isOpen,callback:function(e){t.isOpen=e},expression:"isOpen"}},[e("v-card",[e("v-card-title",[e("span",{staticClass:"text-h5"},[t._v("Add Payment")])]),t._v(" "),e("v-card-text",[e("form-alert",{attrs:{id:"error-component",form:t.payment}}),t._v(" "),e("v-container",[e("v-row",[e("v-col",{attrs:{cols:"12",sm:"12",md:"12"}},[e("user-lookup",{attrs:{"user-type":"User","allow-create":""},on:{selected:t.selectUser}})],1)],1),t._v(" "),e("v-row",[e("v-col",{attrs:{cols:"12",sm:"6",md:"6"}},[e("date-picker",{attrs:{label:"Payment Date"},model:{value:t.payment.paymentTime,callback:function(e){t.$set(t.payment,"paymentTime",e)},expression:"payment.paymentTime"}})],1),t._v(" "),e("v-col",{attrs:{cols:"12",sm:"6",md:"6"}},[e("v-select",{attrs:{items:["Cash","Bank Transfer"],label:"Payment Date *",required:""},model:{value:t.payment.paymentMode,callback:function(e){t.$set(t.payment,"paymentMode",e)},expression:"payment.paymentMode"}})],1),t._v(" "),e("v-col",{attrs:{cols:"12"}},[e("v-text-field",{attrs:{label:"Description",hint:"Enter the description for later reference.","persistent-hint":""},model:{value:t.payment.description,callback:function(e){t.$set(t.payment,"description",e)},expression:"payment.description"}})],1),t._v(" "),e("v-col",{attrs:{cols:"12"}},[e("v-text-field",{attrs:{label:"Reference *",hint:"Enter the payment reference if there is any.","persistent-hint":"",required:""},model:{value:t.payment.reference,callback:function(e){t.$set(t.payment,"reference",e)},expression:"payment.reference"}})],1),t._v(" "),e("v-col",{attrs:{cols:"12"}},[e("v-text-field",{attrs:{label:"Amount *",type:"number",required:""},model:{value:t.payment.amount,callback:function(e){t.$set(t.payment,"amount",e)},expression:"payment.amount"}})],1)],1)],1),t._v(" "),e("small",[t._v("* indicates required field")])],1),t._v(" "),e("v-card-actions",[e("v-spacer"),t._v(" "),e("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:t.closeModal}},[t._v("\n        Close\n      ")]),t._v(" "),e("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:t.addPayment}},[t._v("\n        Save\n      ")])],1)],1)],1)}),[],!1,null,null,null).exports},396:(t,e,s)=>{s.r(e),s.d(e,{default:()=>n});const a={components:{PaymentModal:s(2426).default},props:{userId:{type:[String,Number],default:0}},data:function(){return{totalItems:0,loading:!0,options:{},headers:[{text:"ID",value:"id"},{text:"Date",value:"paymentTime"},{text:"User",value:"user"},{text:"Mode",value:"paymentMode"},{text:"Linked",value:"linkedTo"},{text:"Total",value:"amount"},{text:"Created At",value:"createdAt"},{text:"Actions",value:"actions",sortable:!1}],items:[],searchText:"",user:0,paymentDialog:!1}},computed:{visibleHeaders:function(){var t=[];return this.userId&&t.push("user"),this.headers.filter((function(e){return!t.includes(e.value)}))}},watch:{options:{handler:function(){this.loadData()},deep:!0}},mounted:function(){this.userId&&(this.user=this.userId)},methods:{selectUser:function(t){this.user=t.id||0,this.loadData()},loadData:function(){var t=this;this.loading=!0;var e=this.options,s=e.sortBy,a=e.sortDesc,n=e.page,o=e.itemsPerPage;this.$http.get("/api/payments?per_page=".concat(o,"&page=").concat(n,"&orderBy=").concat(s,"&orderDesc=").concat(a,"&q=").concat(this.searchText,"&userId=").concat(this.user)).then((function(e){var s=e.data,a=s.meta,n=s.data;t.totalItems=a&&a.total,t.items=n||[],t.loading=!1})).catch((function(e){t.totalItems=0,t.loading=!1,e.response&&e.response.data&&t.$set(t.form,"errorMessage",e.response.data.message),console.log(e)}))},deletePayment:function(t){var e=this;this.$confirm.fire({icon:"warning",title:"Delete Confirm",text:"Are you sure you want to delete this payment?",showCloseButton:!0,showCancelButton:!0,confirmButtonText:"Confirm",cancelButtonText:"Cancel"}).then((function(s){s.isConfirmed&&e.$http.delete("/api/payments/".concat(t)).then((function(t){var s=t.data;e.$store.dispatch("snackbar/showMessage",s.message),e.loadData()}))}))}}};const n=(0,s(1900).Z)(a,(function(){var t=this,e=t._self._c;return e("v-card",{attrs:{rounded:"lg"}},[e("v-card-title",[t._v("Payments")]),t._v(" "),e("v-card-text",{staticClass:"d-flex align-center flex-wrap"},[e("v-text-field",{staticClass:"search-input me-3",attrs:{dense:"","hide-details":"",placeholder:"Search"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.loadData.apply(null,arguments)}},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}}),t._v(" "),t.userId?t._e():e("user-lookup",{staticClass:"search-input me-3",attrs:{"user-type":"User"},on:{selected:t.selectUser}}),t._v(" "),e("v-spacer"),t._v(" "),e("div",{staticClass:"d-flex align-center flex-wrap"},[e("v-btn",{attrs:{color:"primary"},on:{click:function(e){t.paymentDialog=!0}}},[e("v-icon",[t._v("\n          mdi-plus\n        ")]),t._v("\n        New Payment\n      ")],1)],1)],1),t._v(" "),e("v-data-table",{attrs:{headers:t.visibleHeaders,items:t.items,options:t.options,"server-items-length":t.totalItems,loading:t.loading,"item-key":"name"},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.user",fn:function(e){var s=e.item;return[t._v("\n      "+t._s(s.user)+"\n    ")]}},{key:"item.amount",fn:function(e){var s=e.item;return[t._v("\n      "+t._s(t._f("currency")(s.amount))+"\n    ")]}},{key:"item.actions",fn:function(s){var a=s.item;return[e("v-icon",{attrs:{small:""},on:{click:function(e){return t.$router.push({name:"sales.view",params:{saleId:a.id}})}}},[t._v("\n        mdi-eye\n      ")]),t._v(" "),e("v-icon",{attrs:{small:""},on:{click:function(e){return t.$router.push({name:"sales.edit",params:{saleId:a.id}})}}},[t._v("\n        mdi-pencil\n      ")]),t._v(" "),e("v-icon",{attrs:{small:"",color:"red"},on:{click:function(e){return t.deletePayment(a.id)}}},[t._v("\n        mdi-delete\n      ")])]}}])}),t._v(" "),e("payment-modal",{on:{reload:t.loadData},model:{value:t.paymentDialog,callback:function(e){t.paymentDialog=e},expression:"paymentDialog"}})],1)}),[],!1,null,"70c25134",null).exports},3607:(t,e,s)=>{s.r(e),s.d(e,{default:()=>n});const a={middleware:"auth",props:{supplierId:{type:[String,Number],default:0}},data:function(){return{totalItems:0,loading:!0,options:{},headers:[{text:"ID",value:"id"},{text:"Date",value:"purchaseTime"},{text:"Supplier",value:"supplier"},{text:"Qty",value:"totalQty"},{text:"Total",value:"totalAmount"},{text:"Balance",value:"balance"},{text:"Created At",value:"createdAt"},{text:"Actions",value:"actions",sortable:!1}],items:[],searchText:"",supplier:0}},computed:{visibleHeaders:function(){var t=[];return this.supplierId&&t.push("supplier"),this.headers.filter((function(e){return!t.includes(e.value)}))}},watch:{options:{handler:function(){this.loadData()},deep:!0}},mounted:function(){this.supplierId&&(this.supplier=this.supplierId)},methods:{selectSupplier:function(t){this.supplier=t.id||0,this.loadData()},loadData:function(){var t=this;this.loading=!0;var e=this.options,s=e.sortBy,a=e.sortDesc,n=e.page,o=e.itemsPerPage;this.$http.get("/api/purchases?per_page=".concat(o,"&page=").concat(n,"&orderBy=").concat(s,"&orderDesc=").concat(a,"&q=").concat(this.searchText,"&supplier=").concat(this.supplierId)).then((function(e){var s=e.data,a=s.meta,n=s.data;t.totalItems=a&&a.total,t.items=n||[],t.loading=!1})).catch((function(e){t.totalItems=0,t.loading=!1,e.response&&e.response.data&&t.$set(t.form,"errorMessage",e.response.data.message),console.log(e)}))},deletePurchase:function(t){var e=this;this.$confirm.fire({icon:"warning",title:"Delete Confirm",text:"Are you sure you want to delete this sale?",showCloseButton:!0,showCancelButton:!0,confirmButtonText:"Confirm",cancelButtonText:"Cancel"}).then((function(s){s.isConfirmed&&e.$http.delete("/api/sales/".concat(t)).then((function(t){var s=t.data;e.$store.dispatch("snackbar/showMessage",s.message),e.loadData()}))}))}}};const n=(0,s(1900).Z)(a,(function(){var t=this,e=t._self._c;return e("v-card",{attrs:{rounded:"lg"}},[e("v-card-title",[t._v("Purchases")]),t._v(" "),e("v-card-text",{staticClass:"d-flex align-center flex-wrap pb-0"},[e("v-text-field",{staticClass:"search-input me-3 mb-4",attrs:{outlined:"",dense:"","hide-details":"",placeholder:"Search"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.loadData.apply(null,arguments)}},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}}),t._v(" "),t.supplierId?t._e():e("user-lookup",{staticClass:"search-input me-3 mb-4",attrs:{"user-type":"Supplier"},on:{selected:t.selectSupplier}}),t._v(" "),e("v-spacer"),t._v(" "),e("div",{staticClass:"d-flex align-center flex-wrap"},[e("v-btn",{staticClass:"me-3 mb-4",attrs:{color:"primary",to:{name:"purchases.add"}}},[e("v-icon",[t._v("\n          mdi-plus\n        ")]),t._v("\n        New Purchase\n      ")],1)],1)],1),t._v(" "),e("v-data-table",{attrs:{headers:t.visibleHeaders,items:t.items,options:t.options,"server-items-length":t.totalItems,loading:t.loading,"item-key":"name"},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.supplier",fn:function(e){var s,a,n=e.item;return[t._v("\n      "+t._s(null===(s=n.supplier)||void 0===s?void 0:s.id)+" -- "+t._s(null===(a=n.supplier)||void 0===a?void 0:a.name)+"\n    ")]}},{key:"item.total_amount",fn:function(e){var s=e.item;return[t._v("\n      "+t._s(t._f("currency")(s.total_amount))+"\n    ")]}},{key:"item.actions",fn:function(s){var a=s.item;return[e("v-icon",{attrs:{small:""},on:{click:function(e){return t.$router.push({name:"purchases.view",params:{purchaseId:a.id}})}}},[t._v("\n        mdi-eye\n      ")]),t._v(" "),e("v-icon",{attrs:{small:""},on:{click:function(e){return t.$router.push({name:"purchases.edit",params:{purchaseId:a.id}})}}},[t._v("\n        mdi-pencil\n      ")]),t._v(" "),e("v-icon",{attrs:{small:"",color:"red"},on:{click:function(e){return t.deletePurchase(a.id)}}},[t._v("\n        mdi-delete\n      ")])]}}])})],1)}),[],!1,null,"14bf35bc",null).exports},5060:(t,e,s)=>{s.r(e),s.d(e,{default:()=>n});const a={middleware:"auth",props:{customerId:{type:[String,Number],default:0}},data:function(){return{totalItems:0,loading:!0,options:{},headers:[{text:"ID",value:"id"},{text:"Date",value:"saleTime"},{text:"Customer",value:"customer"},{text:"Qty",value:"totalQty"},{text:"Total",value:"totalAmount"},{text:"Balance",value:"balance"},{text:"Created At",value:"createdAt"},{text:"Actions",value:"actions",sortable:!1}],items:[],searchText:"",customer:0}},computed:{visibleHeaders:function(){var t=[];return this.customerId&&t.push("customer"),this.headers.filter((function(e){return!t.includes(e.value)}))}},watch:{options:{handler:function(){this.loadData()},deep:!0}},mounted:function(){this.customerId&&(this.customer=this.customerId)},methods:{selectCustomer:function(t){this.customer=t.id||0,this.loadData()},loadData:function(){var t=this;this.loading=!0;var e=this.options,s=e.sortBy,a=e.sortDesc,n=e.page,o=e.itemsPerPage;this.$http.get("/api/sales?per_page=".concat(o,"&page=").concat(n,"&orderBy=").concat(s,"&orderDesc=").concat(a,"&q=").concat(this.searchText,"&customer=").concat(this.customer)).then((function(e){var s=e.data,a=s.meta,n=s.data;t.totalItems=a&&a.total,t.items=n||[],t.loading=!1})).catch((function(e){t.totalItems=0,t.loading=!1,e.response&&e.response.data&&t.$set(t.form,"errorMessage",e.response.data.message),console.log(e)}))},deleteSale:function(t){var e=this;this.$confirm.fire({icon:"warning",title:"Delete Confirm",text:"Are you sure you want to delete this sale?",showCloseButton:!0,showCancelButton:!0,confirmButtonText:"Confirm",cancelButtonText:"Cancel"}).then((function(s){s.isConfirmed&&e.$http.delete("/api/sales/".concat(t.id)).then((function(t){var s=t.data;e.$store.dispatch("snackbar/showMessage",s.message),e.loadData()}))}))}}};const n=(0,s(1900).Z)(a,(function(){var t=this,e=t._self._c;return e("v-card",{attrs:{rounded:"lg"}},[e("v-card-title",[t._v("Sales")]),t._v(" "),e("v-card-text",{staticClass:"d-flex align-center flex-wrap"},[e("v-text-field",{staticClass:"search-input me-3",attrs:{dense:"","hide-details":"",placeholder:"Search"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.loadData.apply(null,arguments)}},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}}),t._v(" "),t.customerId?t._e():e("user-lookup",{staticClass:"search-input me-3",attrs:{"user-type":"Customer"},on:{selected:t.selectCustomer}}),t._v(" "),e("v-spacer"),t._v(" "),e("div",{staticClass:"d-flex align-center flex-wrap"},[e("v-btn",{attrs:{color:"primary",to:{name:"sales.add"}}},[e("v-icon",[t._v("\n          mdi-plus\n        ")]),t._v("\n        New Sale\n      ")],1)],1)],1),t._v(" "),e("v-data-table",{attrs:{headers:t.visibleHeaders,items:t.items,options:t.options,"server-items-length":t.totalItems,loading:t.loading,"item-key":"name"},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.customer",fn:function(e){var s,a,n=e.item;return[t._v("\n      "+t._s(null===(s=n.customer)||void 0===s?void 0:s.id)+" -- "+t._s(null===(a=n.customer)||void 0===a?void 0:a.name)+"\n    ")]}},{key:"item.total_amount",fn:function(e){var s=e.item;return[t._v("\n      "+t._s(t._f("currency")(s.total_amount))+"\n    ")]}},{key:"item.actions",fn:function(s){var a=s.item;return[e("v-icon",{attrs:{small:""},on:{click:function(e){return t.$router.push({name:"sales.view",params:{saleId:a.id}})}}},[t._v("\n        mdi-eye\n      ")]),t._v(" "),e("v-icon",{attrs:{small:""},on:{click:function(e){return t.$router.push({name:"sales.edit",params:{saleId:a.id}})}}},[t._v("\n        mdi-pencil\n      ")]),t._v(" "),e("v-icon",{attrs:{small:"",color:"red"},on:{click:function(e){return t.deleteSale(a)}}},[t._v("\n        mdi-delete\n      ")])]}}])})],1)}),[],!1,null,"8530a902",null).exports}}]);