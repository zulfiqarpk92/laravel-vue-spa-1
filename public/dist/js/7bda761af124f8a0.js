"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[607],{3607:(e,t,a)=>{a.r(t),a.d(t,{default:()=>n});const s={middleware:"auth",props:{supplierId:{type:[String,Number],default:0}},data:function(){return{totalItems:0,loading:!0,options:{},headers:[{text:"ID",value:"id"},{text:"Date",value:"purchaseTime"},{text:"Supplier",value:"supplier"},{text:"Qty",value:"totalQty"},{text:"Total",value:"totalAmount"},{text:"Balance",value:"balance"},{text:"Created At",value:"createdAt"},{text:"Actions",value:"actions",sortable:!1}],items:[],searchText:"",supplier:0}},computed:{visibleHeaders:function(){var e=[];return this.supplierId&&e.push("supplier"),this.headers.filter((function(t){return!e.includes(t.value)}))}},watch:{options:{handler:function(){this.loadData()},deep:!0}},mounted:function(){this.supplierId&&(this.supplier=this.supplierId)},methods:{selectSupplier:function(e){this.supplier=e.id||0,this.loadData()},loadData:function(){var e=this;this.loading=!0;var t=this.options,a=t.sortBy,s=t.sortDesc,n=t.page,i=t.itemsPerPage;this.$http.get("/api/purchases?per_page=".concat(i,"&page=").concat(n,"&orderBy=").concat(a,"&orderDesc=").concat(s,"&q=").concat(this.searchText,"&supplier=").concat(this.supplierId)).then((function(t){var a=t.data,s=a.meta,n=a.data;e.totalItems=s&&s.total,e.items=n||[],e.loading=!1})).catch((function(t){e.totalItems=0,e.loading=!1,t.response&&t.response.data&&e.$set(e.form,"errorMessage",t.response.data.message),console.log(t)}))},deletePurchase:function(e){var t=this;this.$confirm.fire({icon:"warning",title:"Delete Confirm",text:"Are you sure you want to delete this sale?",showCloseButton:!0,showCancelButton:!0,confirmButtonText:"Confirm",cancelButtonText:"Cancel"}).then((function(a){a.isConfirmed&&t.$http.delete("/api/sales/".concat(e)).then((function(e){var a=e.data;t.$store.dispatch("snackbar/showMessage",a.message),t.loadData()}))}))}}};const n=(0,a(1900).Z)(s,(function(){var e=this,t=e._self._c;return t("v-card",{attrs:{rounded:"lg"}},[t("v-card-title",[e._v("Purchases")]),e._v(" "),t("v-card-text",{staticClass:"d-flex align-center flex-wrap pb-0"},[t("v-text-field",{staticClass:"search-input me-3 mb-4",attrs:{outlined:"",dense:"","hide-details":"",placeholder:"Search"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.loadData.apply(null,arguments)}},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}}),e._v(" "),e.supplierId?e._e():t("user-lookup",{staticClass:"search-input me-3 mb-4",attrs:{"user-type":"Supplier"},on:{selected:e.selectSupplier}}),e._v(" "),t("v-spacer"),e._v(" "),t("div",{staticClass:"d-flex align-center flex-wrap"},[t("v-btn",{staticClass:"me-3 mb-4",attrs:{color:"primary",to:{name:"purchases.add"}}},[t("v-icon",[e._v("\n          mdi-plus\n        ")]),e._v("\n        New Purchase\n      ")],1)],1)],1),e._v(" "),t("v-data-table",{attrs:{headers:e.visibleHeaders,items:e.items,options:e.options,"server-items-length":e.totalItems,loading:e.loading,"item-key":"name"},on:{"update:options":function(t){e.options=t}},scopedSlots:e._u([{key:"item.supplier",fn:function(t){var a,s,n=t.item;return[e._v("\n      "+e._s(null===(a=n.supplier)||void 0===a?void 0:a.id)+" -- "+e._s(null===(s=n.supplier)||void 0===s?void 0:s.name)+"\n    ")]}},{key:"item.total_amount",fn:function(t){var a=t.item;return[e._v("\n      "+e._s(e._f("currency")(a.total_amount))+"\n    ")]}},{key:"item.actions",fn:function(a){var s=a.item;return[t("v-icon",{attrs:{small:""},on:{click:function(t){return e.$router.push({name:"purchases.view",params:{purchaseId:s.id}})}}},[e._v("\n        mdi-eye\n      ")]),e._v(" "),t("v-icon",{attrs:{small:""},on:{click:function(t){return e.$router.push({name:"purchases.edit",params:{purchaseId:s.id}})}}},[e._v("\n        mdi-pencil\n      ")]),e._v(" "),t("v-icon",{attrs:{small:"",color:"red"},on:{click:function(t){return e.deletePurchase(s.id)}}},[e._v("\n        mdi-delete\n      ")])]}}])})],1)}),[],!1,null,"14bf35bc",null).exports}}]);